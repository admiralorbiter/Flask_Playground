<!DOCTYPE html>
<html lang="en">
<head>
    <title>Edit Project - {{ project.name }}</title>
    <!-- Include necessary CSS and JS files -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.5.0"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Project Details - {{ project.name }}</h1>

    <!-- Display Project Details -->
    <h2>Project Information</h2>
    <p><strong>Name:</strong> {{ project.name }}</p>
    <p><strong>Overview:</strong> {{ project.overview }}</p>
    <p><strong>Comments:</strong> {{ project.comments }}</p>
    <p><strong>Feedback:</strong> {{ project.feedback }}</p>
    <p><strong>Due Date:</strong> {{ project.due_date.strftime('%Y-%m-%d') if project.due_date else 'Not set' }}</p>
    <p><strong>Priority:</strong> {{ project.priority }}</p>
    <p><strong>Progress:</strong> {{ project.progress|int }}%</p>
    <p><strong>Short Description:</strong> {{ project.short_description }}</p>

    <p><strong>Lead Student:</strong> {{ project.project_lead.name if project.project_lead else "None" }}</p>
    <h3>Team Members</h3>
    <ul>
        {% for student in project.students %}
            <li>{{ student.name }}</li>
        {% endfor %}
    </ul>
    <h3>Links</h3>
    <ul>
        {% for link in project.links %}
        <li id="link-{{ link.id }}">
            <a href="{{ link.url|default('http://' + link.url) }}" target="_blank">{{ link.url }}</a>
            
            <!-- Edit Link Button -->
            <button hx-get="{{ url_for('edit_link', link_id=link.id) }}" hx-target="#link-{{ link.id }}" hx-swap="outerHTML" class="btn btn-sm btn-secondary">Edit</button>
            
            <!-- Delete Link Button -->
            <button hx-post="{{ url_for('delete_link', link_id=link.id) }}" hx-confirm="Are you sure you want to delete this link?" hx-target="closest li" hx-swap="outerHTML" class="btn btn-sm btn-danger">Delete</button>
        </li>
        {% endfor %}
    </ul>
    <!-- Add Link Form -->
    <form action="{{ url_for('add_link') }}" method="post">
        <input type="text" name="url" placeholder="Enter new link">
        <input type="hidden" name="project_id" value="{{ project.project_id }}">
        <button type="submit" class="btn btn-sm btn-primary">Add Link</button>
    </form>

    <!-- Display Tasks -->
    <h2>Tasks</h2>
    {% for task in tasks %}
    <div>
        <h4>{{ task.name }}</h4>
        <p>{{ task.description }}</p>
        <p>Progress: {{ task.progress }}%</p>
        <!-- Add other task details here -->

        <!-- Link to update task (assuming you have a separate page for this) -->
        <a href="{{ url_for('update_task', task_id=task.task_id) }}">Edit Task</a>
    </div>
    {% else %}
    <p>No tasks found for this project.</p>
    {% endfor %}

    <!-- Form to Add a New Task -->
    <h3>Add a New Task</h3>
    <form action="{{ url_for('add_task', project_id=project.project_id) }}" method="post">
        <label for="task_name">Task Name:</label>
        <input type="text" id="task_name" name="task_name">

        <label for="task_description">Description:</label>
        <textarea id="task_description" name="task_description"></textarea>

        <!-- Add other fields for task details -->

        <button type="submit">Add Task</button>
    </form>

    <h1>Edit Project - {{ project.name }}</h1>

    <form action="{{ url_for('update_project', id=project.project_id) }}" method="post">
        <label for="name">Project Name:</label>
        <input type="text" id="name" name="name" value="{{ project.name }}">

        <!-- Date handling needs proper formatting in Flask -->
        <label for="due_date">Due Date:</label>
        <input type="date" id="due_date" name="due_date" value="{{ project.due_date | date_format }}">

        <label for="priority">Priority:</label>
        <input type="text" id="priority" name="priority" value="{{ project.priority }}">

        <label for="progress">Progress:</label>
        <input type="text" id="progress" name="progress" value="{{ project.progress }}">

        <label for="short_description">Short Description:</label>
        <input type="text" id="short_description" name="short_description" value="{{ project.short_description }}">

        <button type="submit">Save Changes</button>
    </form>
</body>
</html>